import 'model.dart';

class FortuneViewModel {
  // 0ï½6 ã¾ã§ãƒãƒ¼ãƒ‰ 7 å€‹ï¼ˆè³ªå• 3 å€‹ + çµæœ 4 å€‹ï¼‰
  final List<Node?> node = List<Node?>.filled(7, null);

  int _currentIndex = 0;

  FortuneViewModel() {
    // ----- è³ªå•ãƒãƒ¼ãƒ‰ (0ã€œ6) -----
    // 0: åŸºæœ¬ã®ã‚¹ã‚­ãƒ³ã‚±ã‚¢ç¿’æ…£
    node[0] = QuestionNode(
      text: "æ™®æ®µã€æœæ™©ã®æ´—é¡”ã‚„ä¿æ¹¿ãªã©åŸºæœ¬çš„ãªã‚¹ã‚­ãƒ³ã‚±ã‚¢ã‚’ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ",
      yes: 1,
      no: 2,
    ); // æ·±ã•1

    // 1: æ°´åˆ†è£œçµ¦
    node[1] = QuestionNode(
      text: "1æ—¥ã«ã‚³ãƒƒãƒ—5æ¯ä»¥ä¸Šã®æ°´ã‚„ãŠèŒ¶ãªã©ã€ã“ã¾ã‚ã«æ°´åˆ†ã‚’ã¨ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ",
      yes: 3,
      no: 4,
    ); // æ·±ã•2 (ã‚¹ã‚­ãƒ³ã‚±ã‚¢ã—ã¦ã„ã‚‹å´)

    // 2: æ²¹ã£ã½ã„é£Ÿã¹ç‰©
    node[2] = QuestionNode(
      text: "é€±ã«3å›ä»¥ä¸Šã€ãƒãƒ†ãƒˆã‚„ãƒ•ãƒ©ã‚¤ãƒ‰ãƒã‚­ãƒ³ã€ã‚¹ãƒŠãƒƒã‚¯è“å­ãªã©æ²¹ã£ã½ã„ç‰©ã‚’é£Ÿã¹ã¾ã™ã‹ï¼Ÿ",
      yes: 5,
      no: 6,
    ); // æ·±ã•2 (ã‚¹ã‚­ãƒ³ã‚±ã‚¢ã‚ã¾ã‚Šã—ã¦ã„ãªã„å´)

    // 3: ç¡çœ æ™‚é–“ãƒ»å°±å¯æ™‚é–“
    node[3] = QuestionNode(
      text: "å¤œã¯ã ã„ãŸã„0æ™‚ã‚ˆã‚Šå‰ã«å¯ã¦ã„ã¾ã™ã‹ï¼Ÿ",
      yes: 7,
      no: 8,
    ); // æ·±ã•3

    // 4: ã‚¹ãƒˆãƒ¬ã‚¹
    node[4] = QuestionNode(
      text: "ã“ã“1é€±é–“ã€å¼·ã„ã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã‹ï¼Ÿ",
      yes: 9,
      no: 10,
    ); // æ·±ã•3

    // 5: ç”˜ã„ã‚‚ã®ãƒ»ç ‚ç³–
    node[5] = QuestionNode(
      text: "ç”˜ã„ãŠè“å­ã‚„ã‚¸ãƒ¥ãƒ¼ã‚¹ã‚’æ¯æ—¥ã®ã‚ˆã†ã«ã¨ã‚Šã¾ã™ã‹ï¼Ÿ",
      yes: 11,
      no: 12,
    ); // æ·±ã•3

    // 6: ãƒ‹ã‚­ãƒ“ã‚’è§¦ã‚‹ãƒ»æ½°ã™ã‹ã©ã†ã‹
    node[6] = QuestionNode(
      text: "ãƒ‹ã‚­ãƒ“ã‚’ã¤ã„è§¦ã£ãŸã‚Šã€æ½°ã—ã¦ã—ã¾ã†ã“ã¨ãŒå¤šã„ã§ã™ã‹ï¼Ÿ",
      yes: 13,
      no: 14,
    ); // æ·±ã•3

    // ----- çµæœãƒãƒ¼ãƒ‰ (7ã€œ14) -----
    // ãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ«ã¯ 0ã€œ100 ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚³ã‚¢
    node[7] = ResultNode(
      emoji: "ğŸŒˆ",
      title: "ã¤ã‚‹ã¤ã‚‹è‚Œã‚¿ã‚¤ãƒ—ï¼ˆãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ« 5/100ï¼‰",
      description: "ã‚¹ã‚­ãƒ³ã‚±ã‚¢ãƒ»æ°´åˆ†ãƒ»ç¡çœ ã®ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ãã€ã¨ã¦ã‚‚è‰¯ã„çŠ¶æ…‹ã§ã™ã€‚"
          "ä»Šã®ç”Ÿæ´»ã‚’ç¶šã‘ã‚Œã°ã€ãƒ‹ã‚­ãƒ“ãŒå¢—ãˆã‚‹ãƒªã‚¹ã‚¯ã¯ã‹ãªã‚Šä½ã‚ã§ã™ã€‚"
          "ã¨ãã©ãè‚Œã®èª¿å­ã‚’ç¢ºèªã—ã¤ã¤ã€ä»Šã®ç¿’æ…£ã‚’ã‚­ãƒ¼ãƒ—ã—ã¾ã—ã‚‡ã†ã€‚",
    );

    node[8] = ResultNode(
      emoji: "ğŸ™‚",
      title: "ã»ã¼å®‰å¿ƒã‚¿ã‚¤ãƒ—ï¼ˆãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ« 20/100ï¼‰",
      description: "åŸºæœ¬çš„ã«ã¯è‰¯ã„ç¿’æ…£ã§ã™ãŒã€ç¡çœ ã‚„æ°´åˆ†ãªã©ã©ã“ã‹ä¸€éƒ¨ãŒæƒœã—ã„çŠ¶æ…‹ã§ã™ã€‚"
          "å°‘ã—ç”Ÿæ´»ãƒªã‚ºãƒ ã‚’æ•´ãˆã‚‹ã ã‘ã§ã€ãƒ‹ã‚­ãƒ“ãƒªã‚¹ã‚¯ã¯ã•ã‚‰ã«ä¸‹ã’ã‚‰ã‚Œã¾ã™ã€‚",
    );

    node[9] = ResultNode(
      emoji: "ğŸ˜—",
      title: "ã‚„ã‚„æ³¨æ„ã‚¿ã‚¤ãƒ—ï¼ˆãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ« 30/100ï¼‰",
      description: "ã‚¹ãƒˆãƒ¬ã‚¹ã‚„ç”Ÿæ´»ãƒªã‚ºãƒ ã®ä¹±ã‚Œã§ã€ãƒ‹ã‚­ãƒ“ãŒå¢—ãˆã‚„ã™ã„çŠ¶æ…‹ã«ãªã‚Šã¤ã¤ã‚ã‚Šã¾ã™ã€‚"
          "è»½ã„é‹å‹•ã‚„ãƒªãƒ©ãƒƒã‚¯ã‚¹ã‚¿ã‚¤ãƒ ã‚’ã¤ãã£ã¦ã€å¿ƒã¨ä½“ã®ã‚±ã‚¢ã‚’ã—ã¦ã‚ã’ã¾ã—ã‚‡ã†ã€‚",
    );

    node[10] = ResultNode(
      emoji: "ğŸ˜¬",
      title: "ç”Ÿæ´»è¦‹ç›´ã—ã‚¿ã‚¤ãƒ—ï¼ˆãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ« 45/100ï¼‰",
      description: "è‚Œã«ã¨ã£ã¦ã‚ã¾ã‚Šè‰¯ããªã„ç¿’æ…£ãŒã„ãã¤ã‹é‡ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚"
          "å¯ã‚‹æ™‚é–“ã‚’å°‘ã—æ—©ãã™ã‚‹ãƒ»æ°´ã‚„ãŠèŒ¶ã‚’å¢—ã‚„ã™ãªã©ã€å°ã•ãªæ”¹å–„ã‹ã‚‰å§‹ã‚ã‚‹ã¨åŠ¹æœãŒå‡ºã‚„ã™ã„ã§ã™ã€‚",
    );

    node[11] = ResultNode(
      emoji: "ğŸ˜£",
      title: "ãƒ‹ã‚­ãƒ“å‡ºã‚„ã™ã„ã‚¿ã‚¤ãƒ—ï¼ˆãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ« 60/100ï¼‰",
      description: "æ²¹ã£ã½ã„é£Ÿã¹ç‰©ã‚„ç”˜ã„ã‚‚ã®ã€ç”Ÿæ´»ãƒªã‚ºãƒ ã®ä¹±ã‚Œãªã©ãŒé‡ãªã£ã¦ã€"
          "ãƒ‹ã‚­ãƒ“ãŒã§ãã‚„ã™ã„ç’°å¢ƒã«ãªã£ã¦ã„ã¾ã™ã€‚ã¾ãšã¯ã©ã‚Œã‹1ã¤ã ã‘ã§ã‚‚æ¸›ã‚‰ã—ã¦ã¿ã‚‹ã®ãŒãŠã™ã™ã‚ã§ã™ã€‚",
    );

    node[12] = ResultNode(
      emoji: "ğŸ”¥",
      title: "ãƒ‹ã‚­ãƒ“ãƒã‚¤ãƒªã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ï¼ˆãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ« 75/100ï¼‰",
      description: "é£Ÿç”Ÿæ´»ãƒ»ç¡çœ ãƒ»ã‚¹ã‚­ãƒ³ã‚±ã‚¢ã®ã„ãšã‚Œã‹ãŒã€ã‹ãªã‚ŠãŠè‚Œã«è² æ‹…ã‚’ã‹ã‘ã¦ã„ã‚‹ã‚µã‚¤ãƒ³ã§ã™ã€‚"
          "ã„ããªã‚Šå®Œç’§ã‚’ç›®æŒ‡ã•ãšã€ã€å¤œæ›´ã‹ã—ã‚’1æ™‚é–“ã ã‘æ¸›ã‚‰ã™ã€ã€æšã’ç‰©ã‚’é€±1å›æ¸›ã‚‰ã™ã€ãªã©ã€"
          "ç¶šã‘ã‚‰ã‚Œã‚‹ãƒ©ã‚¤ãƒ³ã‹ã‚‰èª¿æ•´ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚",
    );

    node[13] = ResultNode(
      emoji: "ğŸ’¥",
      title: "ãƒ‹ã‚­ãƒ“çˆ†ç™ºæ³¨æ„ã‚¿ã‚¤ãƒ—ï¼ˆãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ« 90/100ï¼‰",
      description: "ãƒ‹ã‚­ãƒ“ã‚’é »ç¹ã«è§¦ã£ãŸã‚Šæ½°ã—ãŸã‚Šã—ã¦ã—ã¾ã†ã¨ã€è·¡ãŒæ®‹ã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚"
          "è§¦ã‚‰ãªã„ãƒ»æ¸…æ½”ãªã‚¿ã‚ªãƒ«ã‚„æ•ã‚«ãƒãƒ¼ã‚’ä½¿ã†ãƒ»ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚­ãƒ³ã‚±ã‚¢ã‚’æ•´ãˆã‚‹ã€ã¨ã„ã†3ç‚¹ã‚’æ„è­˜ã™ã‚‹ã¨"
          "ãŠè‚Œã®çŠ¶æ…‹ãŒã ã‚“ã ã‚“è½ã¡ç€ã„ã¦ãã¾ã™ã€‚",
    );

    node[14] = ResultNode(
      emoji: "â˜ï¸",
      title: "ãŠè‚Œéå¸¸äº‹æ…‹ã‚¿ã‚¤ãƒ—ï¼ˆãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ« 100/100ï¼‰",
      description: "ç”Ÿæ´»ç¿’æ…£ã¨ã‚¹ã‚­ãƒ³ã‚±ã‚¢ã®ä¸¡æ–¹ã§ã€ãŠè‚Œã«ã¨ã£ã¦ã‹ãªã‚Šå³ã—ã„çŠ¶æ…‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚"
          "è‡ªå·±åˆ¤æ–­ã§ç„¡ç†ã«æ½°ã—ãŸã‚Šã›ãšã€å¯èƒ½ã§ã‚ã‚Œã°çš®è†šç§‘ã«ç›¸è«‡ã™ã‚‹ã®ã‚‚ãŠã™ã™ã‚ã§ã™ã€‚"
          "åŒæ™‚ã«ã€ç¡çœ ãƒ»é£Ÿäº‹ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹ã‚±ã‚¢ãªã©ã‚’å°‘ã—ãšã¤æ•´ãˆã¦ã„ãã“ã¨ã§ã€"
          "ãƒ‹ã‚­ãƒ“ãƒ¬ãƒ™ãƒ«ã‚’ã‚†ã£ãã‚Šä¸‹ã’ã¦ã„ã‘ã¾ã™ã€‚",
    );
  }


  Node get currentNode => node[_currentIndex] as Node;
  bool get isFinished => currentNode is ResultNode;

  void restart() => _currentIndex = 0;

  void answer({required bool yes}) {
    final q = currentNode as QuestionNode;
    _currentIndex = yes ? q.yes! : q.no!;
  }
}
